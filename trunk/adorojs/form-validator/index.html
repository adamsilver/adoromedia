<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
	<head>
		<script type="text/javascript" src="jquery-1.3.2.js"></script>
		<script type="text/javascript" src="jquery.color.js"></script>
		<script type="text/javascript" src="Adoro.FormRules.js"></script>
		<script type="text/javascript" src="Adoro.FormValidator3.js"></script>
		<script type="text/javascript">
			
			var h1StartHtml;
			$(document).ready(function() {
				var formNode = $("form")[0];
				
				h1StartHtml = $("h1").html();
				
				var fv = new Adoro.FormValidator(formNode, {
					onValidateStart: function(){
						$("h1").html(h1StartHtml+"(validating)");
					},
					onValidateComplete: function() {
						window.setTimeout(function(){
							$("h1").html(h1StartHtml);
						}, 500);
					},
					onClearErrors: function(validators) {
					
						for(var i = 0; i<validators.length; i++) {
							$(validators[i].field).css("background-color", "");
							var label = $(validators[i].field).parents("div.singleInput").prev("div.indicator").find("label")[0];
							if(label) {
								$(label).find("span.error").remove();
							}
						}
					}
				});
				
				fv.addValidator("username",[{
						method: Adoro.FormRules.notEmpty,
						message: "The error message for username"
					},{
						method: Adoro.FormRules.isLength,
						message: "The username should have a length of 3",
						params: {length: 3}
					}], {
						onFieldValidate: fieldValidate,
						onFieldError: fieldError,
						onFieldSuccess: fieldSuccess,
						validateOnBlur: true
					}
				);

				fv.addValidator("password",[{
						method: Adoro.FormRules.notEmpty,
						message: "The error message for password"
					}], {
						onFieldValidate: fieldValidate,
						onFieldError: fieldError,
						onFieldSuccess: fieldSuccess,
						validateOnBlur: true
					}
				);				
				
				fv.addContextualGroup("submitForm2", ["username"]);
				
			});
			
			function ValidatorOptions() {
				//var labelText = getFieldLabelOrLegend();
				
				function fieldValidate() {
					var fieldContainer = $(this).parents("div.field")[0];
					$(fieldContainer).css("background-color", "#ffffff");
					$(fieldContainer).animate({"backgroundColor": "#eee"});
					$(fieldContainer).animate({"backgroundColor": "#fff"});
					$("h1").html(h1StartHtml+"(validating)");
				}
				
				this.onFieldValidate = fieldValidate;
				this.validateOnBlur = true;
			}
			
			
			function fieldError() {
				$(this).css({"backgroundColor": "#9F1309"},{});

				var label = getFieldLabelOrLegend(this);
				if(label) {
					var span = $(label).find("span.error")[0];
					if(!span) {
						$(label).append('<span class="error">Error</span>')
					}
				}
			}
			
			function fieldSuccess() {
				$(this).css({"backgroundColor": "#2CEF59"},{});
				var label = getFieldLabelOrLegend(this);
				if(label) {
					$(label).find("span.error").remove();
				}
			}
			
			function getFieldLabelOrLegend(fieldNode) {
				var singleInputLabel = $(fieldNode).parents("div.singleInput").prev("div.indicator").find("label")[0];
				if(singleInputLabel !== undefined) {
					return singleInputLabel;
				}
				
				// checkbox group
				var checkboxesLegend = $(fieldNode).parents("div.checkboxes").find("legend")[0];
				if(checkboxesLegend !== undefined) {
					return checkboxesLegend;
				}
				
				// single checkbox (i.e. terms and conditions etc)
				var checkboxesLabel = $(fieldNode).parents("div.checkboxes").find("div.input label")[0];
				if(checkboxesLabel !== undefined) {
					return checkboxesLabel;
				}
				
				// multiple input (i.e. card expiry date (month/year)
				var multipleInputLabel = $(fieldNode).parents("div.multipleInput")[0];
				if(multipleInputLabel !== undefined) {
					return $(fieldNode).prev("label")[0] || $(fieldNode).next("label")[0];
				}
				
				return null;
			}
			

		</script>
	</head>
	<body>
		<h1>Argos Form Validator</h1>
		<div id="container">
			
			<div id="errorContainer">
			</div>
			
			<form method="post" action="index.html">
				<div class="field">
					<div class="indicator">
						<label>YO</label>
					</div>
					<div class="singleInput">
						<input type="text" name="username" />
					</div>
				</div>
				<input type="submit" name="submitForm2" id="submitForm2" value="validate username only"/>
				<div class="field">
					<div class="indicator">
						<label>Password label but you don't need one</label>
					</div>
					<div class="singleInput">
						<input type="text" name="password" />
					</div>
				</div>
				<input type="submit" name="submitForm" />
			</form>
			
		</div>
	</body>
</html>